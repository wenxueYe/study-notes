> [详细文档](https://blog.csdn.net/unique_perfect/article/details/111392634)

### 快速开发

[TOC]

<hr />

#### 搭建后台管理系统

> 所有有关人人开源的内容都可以见码云

1. clone renren-fast.git

2. 导入renren-fast 至 Idea后台工程中

    - 充当后台管理系统的角色，由其他的微服务来提供服务

3. 修改

    - 建立数据库，数据库脚本文件为renren-fast中的mysql.sql

    - 修改配置文件

        ```yaml
        # 一般在application.properties文件中,设置端口号，并且可以看到采用的是开发版本，即application-dev.yaml配置
        server:
            port: 8080
        # application-dev.yaml中修改数据源，此时的数据库为方才建立的数据库
                    driver-class-name: com.mysql.cj.jdbc.Driver
                    url: jdbc:mysql://192.168.56.9:3306/gulimall_admin?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai
                    username: root
                    password: root
        ```

- 运行主程序类
    - 如果项目报错误为：无法加载主类
        - 此时使用mvn执行clean、compile即可

#### 搭建前台

1. clone renren-fast-vue.git

2. 导入renren-fast-vue至Vscode中（推荐，也可以用Idea）

    > 最好以管理员身份打开，否则后面总要一堆乱七八糟的东西，咱又看不懂那些前端的异常

3. 运行前的准备

    > vscode 快捷键 
    >
    > - ctrl+`打开终端

    1. 装好node.js环境

        > 它是一个基于Chrome v8引擎的JavaScript的运行环境，我们关注与node.js的npm功能就行。

        1. node -v 检查版本

        2. 配置npm的镜像源

            > npm是随NodeJS一起安装的包管理工具，类似于maven

            - npm config set registry http://registry.npm.taobao.org/

    2. npm install

        > 类似于下载所有前端所需要的所有组件，我估摸着就和maven给你下载依赖差不多。生成的内容都在node_modules下。

4. 运行

    - npm run dev
    - 登录账户和密码均为admin

5. npm install的过程中踩过的坑

    - [s1-pythonxxx，搞不懂的一个错误](https://blog.csdn.net/qq_23994787/article/details/118051725)
    - [s2-sass的环境问题，也搞不懂什么是sass](https://blog.csdn.net/liyanhui1001/article/details/84379226)
        - 第二个解决方案的执行顺序为
            1. 卸载 npm uninstall --save node-sass 
            2. 安装 cnpm install --save node-sass









#### 逆向工程搭建&使用

- git clone renren-generator

- 导入后端项目

    - 添加到聚合模块中
        - 如果导入出现问题，就直接将generator直接独立打开，也不会影响

- 修改配置文件

    - application.yaml修改数据源

    - application.yaml修改代码生成器的配置信息

        - 主目录
        - 包名
            - 看清楚，应该为org.yewenxue,和本来的目录结构保持一致
        - 模块名
        - 表前缀：如果写了表前缀，每一张表对于的javaBean就不会添加前缀了 

    - 修改生成的template的controller部分，修改模板

        - 注释

            - ```java
                注释掉product项目下类中的//import org.apache.shiro.authz.annotation.RequiresPermissions;，他是shiro的东西
                
                注释renren-generator\src\main\resources\template/Controller中所有的
                # @RequiresPermissions。
                # import org.apache.shiro.authz.annotation.RequiresPermissions;
                
                ```

- 执行主程序

    - 端口占用，可以修改，我的为8578

- 生成CRUD代码

- 粘贴main目录

    - 是粘贴，因为生成的是不带启动类的，所以直接合并即可

- 处理生成的项目依赖报错

    - Service的实现
        - Mybatis-Plus的依赖
        - renren-fast的common中的公共类
    - 实体类
        - lombok依赖
        - mybatis-plus
    - dao
        - mybatis-plus
    - controller
        - 如果前面没注释掉template中的内容，现在面临shrio的权限，忽略
        - 缺少renren-fast的common中的公共类

- 创建一个公共模块(创建成maven项目即可)

    - gulimall-common
    - 每一个微服务公共的依赖以及Bean以及工具类等都放在该项目底下，即独立依赖该项目即可
    - 引入公共依赖
        - Lombok
        - MyBatis-Plus
    - 引入公共类
    - 至于还有一些如Controller中的HttpStatus等的，要学会自己解决，去maven rep中去寻找，找到相关依赖添加即可
        - Apache HttpCore
    - 公共类本身引入的内容会缺少一些依赖
        - 基本都在renrenfast后台工程中
        - 或者在renrenfast中引用过
            - 保持和renrenfast中的版本号一致
    - 

- 让服务模块依赖公共模块

- 存在一些问题

    - 都是jdk5https://blog.csdn.net/idiot_qi/article/details/105149846
    - 其实就是mvn默认为5，需要去修改一下settings
    - ![image-20220115020322732](F:\studyNotes\笔记\项目开发日记\谷粒商城\S2-快速开发.assets\image-20220115020322732.png)

#### 配置&测试微服务基本CRUD

- 在order项目下

    1. 整合MyBatis-plus

        1. 导入依赖

            1. common

        2. 配置

            1. 配置数据源

                1. 导入数据库驱动
                    1. 因为后面所有的模块都要使用，所以导入到common中更方便
                        1. 数据库的版本为5.7，去maven仓库，发现并没有5.7版本，官方在文档中说明了版本的对应关系，：Versions and the MySQL and java Versions They support
                            1. 适配问题
                        2. 选择8.0即可
                2. 在application中配置数据源相关信息
                    1. 好像只有8.0以上才要cj那个，我的是5.7；好的吧，报错了，就得是cj

            2. 配置Mybatis-plus相关的信息

                1. 给启动类@MapperScan("org.yewenxue.order.dao")

                2. 告知SQL映射文件位置&主键自增

                    1. ```yaml
                        mybatis-plus:
                          mapper-location: classpath: mapper/**/*.xml
                          global-config:
                            db-config:
                              id-type: auto
                        ```

            3. 测试

                1. 在test中进行

                    1. 注入Service

                    2. 执行一个方法

                        1. 插入

                        2. 更新

                        3. 查询：λ表达式，会在后面学，不用着急

                            ```java
                                List<OrderReturnReasonEntity> list = orderReturnReasonService.list(new QueryWrapper<OrderReturnReasonEntity>().eq("id", 1L));
                                list.forEach((item)->{
                                    System.out.println(item);
                                });
                            ```

                            

            4. BUG

                1. 首先就是application.yaml没有mybatis-plus的提示
                2. jar包还冲突https://blog.csdn.net/weixin_43430036/article/details/101531032
                    1. 我是sb，引入的应该是mybatis的场景依赖

#### 你想生成所有微服务基本CRUD代码

- 重复以上过程

- 各自的端口设置

    - > coupon 7000
        >
        > member 8000
        >
        > order 9000
        >
        > product 10000
        >
        > ware 11000

        - 端口占用问题解决方案https://jingyan.baidu.com/article/fb48e8be97ddc92e622e14f3.html

